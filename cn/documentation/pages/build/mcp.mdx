---
title: "使用 MCP 工具"
icon: "microchip"
---

<Note> ⚠️ 本文档由 AI 自动翻译。如有任何不准确之处，请参考[英文原版](/en/documentation/pages/build/mcp)。</Note>


将来自 [MCP 服务器](https://modelcontextprotocol.io/introduction) 的外部工具连接到你的 Dify 应用程序。你可以使用不断增长的 [MCP 生态系统](https://mcpservers.org/) 中的工具，而不仅仅是内置工具。

<Note>
  本内容涵盖在 Dify 中使用 MCP 工具。要将 Dify 应用程序发布为 MCP 服务器，请参阅[这里](/en/guides/application-publishing/publish-mcp)。
</Note>

<Info>
  目前仅支持使用 [HTTP 传输](https://modelcontextprotocol.io/docs/concepts/architecture#transport-layer) 的 MCP 服务器。
</Info>

## 添加 MCP 服务器

在你的工作空间中转到**工具** → **MCP**。

![](/images/6cef1436fcc13a65ccedb54bcf5ab77eb87b8faba1098a85951839fb1907f2d2.png)

点击**添加 MCP 服务器 (HTTP)**：

![](/images/b5429131836c1caae84f4ce8b3b806221e39636723644961ce2f2a97d5421f16.png)

**服务器 URL**：MCP 服务器的位置（如 `https://api.notion.com/mcp`）

**名称和图标**：给它一个有用的名称。Dify 会尝试自动获取图标。

**服务器 ID**：唯一标识符（小写字母、数字、下划线、连字符，最多 24 个字符）

<Warning>
  一旦开始使用服务器 ID，就不要更改它。这将破坏任何使用该服务器工具的应用程序。
</Warning>

## 接下来会发生什么

Dify 会自动：
1. 连接到服务器
2. 处理任何 OAuth 认证
3. 获取可用工具列表
4. 使它们在你的应用程序构建器中可用

一旦找到工具，你将看到服务器卡片：

![](/images/fcef5ecad1deca82a1d8988c4bcb7cec745a0cd47945ff05fca588502cfaafbc.png)

## 管理服务器

点击任何服务器卡片可以：

**更新工具**：当外部服务添加新工具时刷新

![](/images/7b526a64ff34b10a357511b2cd3e42f251a6786210eac71c58ca7bfccdf63f0c.png)

**重新授权**：当令牌过期时修复认证

**编辑设置**：更改服务器详细信息（但不能更改 ID！）

**移除**：断开服务器连接（这会破坏使用其工具的应用程序）

## 使用 MCP 工具

连接后，MCP 工具会出现在你期望的所有地方：

**在智能代理中**：工具按服务器分组显示（"Notion MCP » Create Page"）

**在工作流中**：MCP 工具作为节点可用

**在智能代理节点中**：与常规智能代理相同

## 自定义工具

添加 MCP 工具时，你可以自定义它：

![](/images/CleanShot2025-07-07at07.41.33@2x.png)

**描述**：覆盖默认描述以使其更具体

**参数**：对于每个工具参数，选择：
- **自动**：让 AI 决定值
- **固定**：设置一个永不改变的特定值

**示例**：对于搜索工具，将 `numResults` 设置为 5（固定），但保持 `query` 为自动。

## 分享应用程序

当你导出使用 MCP 工具的应用程序时：
- 导出内容包含服务器 ID
- 要在其他地方使用该应用程序，需要添加具有相同 ID 的相同服务器
- 记录你的应用程序需要哪些 MCP 服务器

## 故障排除

**"未配置的服务器"**：检查 URL 并重新授权

**缺少工具**：点击"更新工具"

**应用程序损坏**：你可能更改了服务器 ID。使用原始 ID 重新添加它。

## 提示

- 使用永久的、描述性的服务器 ID，如 `github-prod` 或 `crm-system`
- 在开发/测试/生产环境中保持相同的 MCP 设置
- 为配置项设置固定值，为部署前测试 MCP 集成
