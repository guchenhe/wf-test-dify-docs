---
title: "变量赋值器"
icon: "pen-to-square"
---

<Note> ⚠️ 本文档由 AI 自动翻译。如有任何不准确之处，请参考[英文原版](/en/documentation/pages/nodes/variable-assigner)。</Note>


变量赋值器节点通过写入会话变量来管理对话流应用中的持久化数据。与每次执行都会重置的常规工作流变量不同，会话变量在整个聊天会话期间持续存在。

<Frame caption="变量赋值器节点配置">
  <img src="https://assets-docs.dify.ai/2024/11/83d0b9ef4c1fad947b124398d472d656.png" alt="Variable Assigner interface" />
</Frame>

## 会话变量 vs 工作流变量

**工作流变量**仅在单次工作流执行期间存在，并在工作流完成时重置。

**会话变量**在同一聊天会话中的多个对话轮次之间持续存在，支持有状态交互和上下文记忆。

这种持久性支持上下文对话、用户个性化、有状态工作流，以及跨多个用户交互的进度跟踪。

## 配置

配置要更新的会话变量并指定其源数据。你可以在单个节点中分配多个变量。

<Frame caption="变量分配配置界面">
  <img src="https://assets-docs.dify.ai/2024/11/ee15dee864107ba5a93b459ebdfc32cf.png" alt="Variable assignment configuration" />
</Frame>

**变量** - 选择要写入的会话变量

**设置变量** - 从上游工作流节点中选择源数据

**操作模式** - 确定如何更新变量（覆写、追加、清除等）

## 操作模式

不同变量类型根据其数据结构支持不同的操作：

<Tabs>
  <Tab title="字符串变量">
    **覆写** - 用新内容替换整个字符串值
    
    **清除** - 清空变量，将其设置为null或空白
    
    **设置** - 手动输入固定值
  </Tab>
  
  <Tab title="数字变量">
    **覆写** - 完全替换数字值
    
    **清除** - 设置为null或空状态
    
    **设置** - 手动输入特定数字值
    
    **算术运算** - 对当前值进行加、减、乘、除操作
  </Tab>
  
  <Tab title="对象变量">
    **覆写** - 用新数据替换整个对象
    
    **清除** - 清空对象，移除所有属性
    
    **设置** - 手动定义对象结构和值
  </Tab>
  
  <Tab title="数组变量">
    **覆写** - 用新数据替换整个数组
    
    **清除** - 清空数组，移除所有元素
    
    **追加** - 在数组末尾添加一个项目
    
    **扩展** - 从另一个数组添加多个项目
    
    **移除** - 从第一个或最后一个位置删除项目
  </Tab>
</Tabs>

数组操作在构建记忆系统、清单和随时间增长的对话历史记录方面特别强大。

## 常见实现模式

### 智能记忆系统

构建能够自动检测和存储对话中重要信息的聊天机器人：

<Frame caption="智能记忆系统工作流">
  <img src="https://assets-docs.dify.ai/dify-enterprise-mintlify/en/guides/workflow/node/8d0492814b1515f50e87b2900ff400db.png" alt="Smart memory implementation" />
</Frame>

系统分析用户输入中的可记忆事实，提取结构化信息，并将其追加到持久化记忆数组中，以便在未来的对话中参考。

### 用户偏好存储

存储用户偏好，如语言设置、通知偏好或显示选项：

<Frame caption="用户偏好管理">
  <img src="https://assets-docs.dify.ai/dify-enterprise-mintlify/en/guides/workflow/node/1867d608a7d009431b73377ed65b427b.png" alt="User preferences workflow" />
</Frame>

从用户输入中捕获初始偏好，然后在所有后续大型语言模型响应中引用它们，实现个性化交互。

### 渐进式清单

构建跨多个对话轮次跟踪完成状态的引导式工作流：

<Frame caption="渐进式清单实现">
  <img src="https://assets-docs.dify.ai/dify-enterprise-mintlify/en/guides/workflow/node/c4362b01298b12e7d6fcd9e798f3165a.png" alt="Progressive checklist workflow" />
</Frame>

使用数组会话变量跟踪已完成的项目。变量赋值器在每轮更新清单，而大型语言模型引用它来指导用户完成剩余任务。

## 最佳实践

**选择适当的数据类型** - 对于不断增长的集合使用数组，对于结构化数据使用对象，对于单个值使用简单类型。

**使用描述性变量名** - 清晰地命名会话变量以表明其用途和内容。

**处理数据增长** - 监控数组和对象大小，防止在长对话中过度使用内存。

**初始化变量** - 为会话变量设置初始值以防止未定义行为。

**适当时清除** - 在开始新流程或会话时使用清除操作来重置变量。
