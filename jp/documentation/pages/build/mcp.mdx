---
title: "MCPツールの使用"
icon: "microchip"
---

<Note> ⚠️ このドキュメントはAIによって自動翻訳されています。不正確な部分がある場合は、[英語版](/en/documentation/pages/build/mcp)を参照してください。</Note>


[MCPサーバー](https://modelcontextprotocol.io/introduction)から外部ツールをDifyアプリに接続します。組み込みツールだけでなく、成長する[MCPエコシステム](https://mcpservers.org/)のツールも使用できます。

<Note>
  これはDifyでMCPツールを使用することについて説明しています。DifyアプリをMCPサーバーとして公開する場合は、[こちら](/en/guides/application-publishing/publish-mcp)をご覧ください。
</Note>

<Info>
  現在、[HTTPトランスポート](https://modelcontextprotocol.io/docs/concepts/architecture#transport-layer)を使用するMCPサーバーのみをサポートしています。
</Info>

## MCPサーバーの追加

ワークスペースで**ツール** → **MCP**に移動します。

![](/images/6cef1436fcc13a65ccedb54bcf5ab77eb87b8faba1098a85951839fb1907f2d2.png)

**MCPサーバーを追加（HTTP）**をクリック：

![](/images/b5429131836c1caae84f4ce8b3b806221e39636723644961ce2f2a97d5421f16.png)

**サーバーURL**：MCPサーバーの場所（例：`https://api.notion.com/mcp`）

**名前とアイコン**：わかりやすい名前を付けてください。Difyはアイコンを自動的に取得しようとします。

**サーバーID**：一意の識別子（小文字、数字、アンダースコア、ハイフン、最大24文字）

<Warning>
  サーバーIDを使い始めたら、絶対に変更しないでください。このサーバーのツールを使用するアプリが壊れてしまいます。
</Warning>

## 次に起こること

Difyは自動的に：
1. サーバーに接続
2. OAuth処理を実行
3. 使用可能なツールのリストを取得
4. アプリビルダーで使用できるようにします

ツールが見つかると、サーバーカードが表示されます：

![](/images/fcef5ecad1deca82a1d8988c4bcb7cec745a0cd47945ff05fca588502cfaafbc.png)

## サーバーの管理

任意のサーバーカードをクリックすると：

**ツールの更新**：外部サービスが新しいツールを追加した際に更新

![](/images/7b526a64ff34b10a357511b2cd3e42f251a6786210eac71c58ca7bfccdf63f0c.png)

**再認証**：トークンの期限切れ時に認証を修正

**設定の編集**：サーバーの詳細を変更（IDは除く！）

**削除**：サーバーを切断（そのツールを使用するアプリが壊れます）

## MCPツールの使用

接続されると、MCPツールは予想される場所すべてに表示されます：

**エージェント内**：ツールはサーバー別にグループ化されて表示（「Notion MCP » ページ作成」）

**ワークフロー内**：MCPツールはノードとして使用可能

**エージェントノード内**：通常のエージェントと同じ

## ツールのカスタマイズ

MCPツールを追加する際、カスタマイズできます：

![](/images/CleanShot2025-07-07at07.41.33@2x.png)

**説明**：デフォルトの説明をより具体的にオーバーライド

**パラメータ**：各ツールパラメータについて、選択できます：
- **自動**：AIに値を決定させる
- **固定**：変更されない特定の値を`numResults`を5（固定）に設定し、`query`は自動のままにします。

## アプリの共有

MCPツールを使用するアプリをエクスポートする場合：
- エクスポートにはサーバーIDが含まれます
- アプリを他の場所で使用するには、同じIDで同じサーバーを追加してください
- アプリに必要なMCPサーバーを文書化してください

## トラブルシューティング

**「未設定サーバー」**：URLを確認し、再認証してください

**不足しているツール**：「ツールの更新」を実行してください

**壊れたアプリ**：おそらくサーバーIDを変更したでしょう。元のIDで再度追加してください。

## ヒント

- `github-prod`や`crm-system`のような永続的で説明的なサーバーIDを使用してください
- 開発/ステージング/本番環境で同じMCP設定を維持してください
- 設定項目には固定値を、動的入力には自動を設定してください
- デプロイ前にMCP統合をテストしてください
